{"version":3,"sources":["webpack:///./src/views/image/index.vue?de86","webpack:///./src/views/image/index.vue?bc32","webpack:///src/views/image/index.vue","webpack:///./src/views/image/index.vue?1ec3","webpack:///./src/views/image/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","staticStyle","on","changeCollect","model","value","reqParams","callback","$$v","$set","expression","openDialog","dialogVisible","$event","headers","uploadSuccess","imageUrl","_l","image","key","id","url","class","red","is_collected","toCollect","toDel","total","page","per_page","changePager","_e","staticRenderFns","msg","updateStatus","component"],"mappings":"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","file":"js/chunk-22172e6e.765881f1.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=0b66038e&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=0b66038e&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container-image\"},[_c('el-card',[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('my-bread',[_vm._v(\"素材管理\")])],1),_c('el-radio-group',{staticStyle:{\"margin-bottom\":\"20px\"},attrs:{\"size\":\"small\"},on:{\"change\":_vm.changeCollect},model:{value:(_vm.reqParams.collect),callback:function ($$v) {_vm.$set(_vm.reqParams, \"collect\", $$v)},expression:\"reqParams.collect\"}},[_c('el-radio-button',{attrs:{\"size\":\"small\",\"label\":false}},[_vm._v(\"全部\")]),_c('el-radio-button',{attrs:{\"size\":\"small\",\"label\":true}},[_vm._v(\"收藏\")])],1),_c('el-button',{staticStyle:{\"float\":\"right\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":_vm.openDialog}},[_vm._v(\"添加素材\")]),_c('el-dialog',{attrs:{\"title\":\"添加素材\",\"visible\":_vm.dialogVisible,\"width\":\"20%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\",\"name\":\"image\",\"show-file-list\":false,\"headers\":_vm.headers,\"on-success\":_vm.uploadSuccess}},[(_vm.imageUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1),_c('div',{staticClass:\"demo-image\"},_vm._l((_vm.images),function(image){return _c('div',{key:image.id,staticClass:\"block\"},[_c('el-image',{staticStyle:{\"width\":\"179px\",\"height\":\"179px\"},attrs:{\"src\":image.url}}),_c('div',{staticClass:\"tiao\"},[_c('i',{staticClass:\"el-icon-star-off\",class:{red: image.is_collected},on:{\"click\":function($event){return _vm.toCollect(image)}}}),_c('i',{staticClass:\"el-icon-delete\",on:{\"click\":function($event){return _vm.toDel(image.id)}}})])],1)}),0),(_vm.total>10)?_c('el-pagination',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"background\":\"\",\"layout\":\"prev, pager, next\",\"current-page\":_vm.reqParams.page,\"page-size\":_vm.reqParams.per_page,\"total\":_vm.total},on:{\"current-change\":_vm.changePager}}):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"container-image\">\n        <!-- 素材管理 -->\n        <el-card>\n            <div slot=\"header\">\n                <my-bread>素材管理</my-bread>\n            </div>\n            <el-radio-group v-model=\"reqParams.collect\" @change=\"changeCollect\" style=\"margin-bottom: 20px;\" size=\"small\">\n                <el-radio-button size=\"small\" :label=\"false\"  >全部</el-radio-button>\n                <el-radio-button size=\"small\" :label=\"true\"  >收藏</el-radio-button>\n            </el-radio-group>\n            <el-button style=\"float: right\" size=\"small\" type=\"success\" @click=\"openDialog\">添加素材</el-button>\n            <el-dialog title=\"添加素材\" :visible.sync=\"dialogVisible\" width=\"20%\">\n                <!-- 组件解析后的内容属于别的组件的内容 -->\n                <el-upload\n                    class=\"avatar-uploader\"\n                    action=\"http://ttapi.research.itcast.cn/mp/v1_0/user/images\"\n                    name=\"image\"\n                    :show-file-list=\"false\"\n                    :headers=\"headers\"\n                    :on-success=\"uploadSuccess\"\n                    >\n                    <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\">\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\n                </el-upload> \n            </el-dialog>\n            <div class=\"demo-image\">\n                <div class=\"block\" v-for=\"image in images\" :key=\"image.id\">\n                    <el-image style=\"width:179px;height:179px\" :src=\"image.url\"></el-image>\n                    <div class=\"tiao\">\n                        <i class=\"el-icon-star-off\" @click=\"toCollect(image)\" :class=\"{red: image.is_collected}\"></i>\n                        <i class=\"el-icon-delete\" @click=\"toDel(image.id)\"></i>\n                    </div>\n                </div>\n            </div>\n\n            <el-pagination \n                style=\"margin-top: 20px;\"\n                background\n                layout=\"prev, pager, next\"\n                v-if=\"total>10\"\n                @current-change=\"changePager\"\n                :current-page=\"reqParams.page\"\n                :page-size=\"reqParams.per_page\"\n                :total=\"total\">\n            </el-pagination>\n        </el-card>\n    </div>\n</template>\n <script>\n import auth from '@/utils/auth'\n export default{\n     name:'page-image',\n     data(){\n         return {\n             reqParams: {\n                 collect:false,\n                 page: 1,\n                per_page: 10\n             },\n             images: [],\n             total: 0,\n             imageUrl: null,\n             dialogVisible: false,\n             headers: {\n                 Authorization: `Bearer ${auth.getUser().token}`\n             }\n         }\n     },\n     created(){\n         this.getImages()\n     },\n     methods:{\n         // 获取全部图片\n         async getImages(){\n            const res = await this.$http.get('user/images', { params: this.reqParams})\n            this.images = res.data.data.results\n            this.total = res.data.data.total_count\n         },\n         changePager(newPage){\n             this.reqParams.page = newPage\n             this.getImages()\n         },\n         changeCollect(collect){\n             this.reqParams.collect = collect\n             this.reqParams.page = 1\n             this.reqParams.per_page = 10\n             this.getImages()\n         },\n         async toCollect(image){\n            const updateStatus = !image.is_collected;\n            try {\n                await this.$http.put('user/images/'+image.id, {collect: updateStatus})\n                let msg=\"\";\n                updateStatus ? msg=\"添加收藏成功\" : msg = '取消收藏成功'\n                this.$message({ type: 'success', message: msg });\n                image.is_collected = updateStatus;\n            } catch (error) {\n                let msg = '';\n                 updateStatus ? msg=\"添加收藏失败\" : msg = '取消收藏失败'\n                this.$message({type: 'error', message: msg}); \n            }\n         },\n         async toDel(id){\n             this.$confirm('此操作将永久删除该图片, 是否继续?', '提示', {\n                confirmButtonText: '确定',\n                cancelButtonText: '取消',\n                type: 'warning'\n            }).then( async () => {\n                try{\n                    const res = await this.$http.delete('user/images/'+id)\n                    this.$message({\n                        type: 'success',\n                        message: '删除成功!'\n                    });\n                    this.getImages()\n                }catch(e){\n                    this.$message({\n                        type: 'info',\n                        message: '删除失败'\n                    });  \n                }\n            }).catch(() => {\n                    \n            });\n         },\n        openDialog(){\n            this.dialogVisible = true\n            this.imageUrl = null\n        },\n        uploadSuccess(response){\n            this.$message.success(\"上传素材成功\")\n            this.imageUrl = response.data.url\n            window.setTimeout(()=>{\n                this.dialogVisible = false;\n                this.getImages()\n            }, 3000)\n        }\n     }\n\n }\n </script>\n <style scoped lang=\"less\">\n.container-image{\n    .demo-image{\n        overflow: hidden;\n        .block{\n             float: left;\n             margin-right: 60px;\n             margin-bottom: 25px;\n             border: 1px dashed #eee;\n             box-sizing: border-box;\n             width:180px;\n             height: 180px;\n             position: relative;\n             .tiao{\n                position: absolute;\n                left: 0;\n                bottom: 0;\n                width: 100%;\n                height: 30px;\n                line-height: 30px;\n                background-color: rgba(0,0,0,0.3);\n                text-align: center;\n                i{\n                    width: 89px;\n                    height: 30px;\n                    color: #fff;  \n                    // 不加&解析后 span .red 后代选择器\n                    // 加&解析后 span.red{} 交集选择器\n                    &.red{\n                        color: red !important;\n                    }\n                }\n             }\n             \n        }\n       \n    }\n    \n}\n </style>\n <style lang=\"less\">\n \n </style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0b66038e&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0b66038e&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0b66038e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}