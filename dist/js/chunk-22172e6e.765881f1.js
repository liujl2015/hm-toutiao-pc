(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22172e6e"],{a477:function(e,t,a){},a74c:function(e,t,a){"use strict";var s=a("a477"),r=a.n(s);r.a},e036:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-image"},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("my-bread",[e._v("素材管理")])],1),a("el-radio-group",{staticStyle:{"margin-bottom":"20px"},attrs:{size:"small"},on:{change:e.changeCollect},model:{value:e.reqParams.collect,callback:function(t){e.$set(e.reqParams,"collect",t)},expression:"reqParams.collect"}},[a("el-radio-button",{attrs:{size:"small",label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{size:"small",label:!0}},[e._v("收藏")])],1),a("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"success"},on:{click:e.openDialog}},[e._v("添加素材")]),a("el-dialog",{attrs:{title:"添加素材",visible:e.dialogVisible,width:"20%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images",name:"image","show-file-list":!1,headers:e.headers,"on-success":e.uploadSuccess}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("div",{staticClass:"demo-image"},e._l(e.images,(function(t){return a("div",{key:t.id,staticClass:"block"},[a("el-image",{staticStyle:{width:"179px",height:"179px"},attrs:{src:t.url}}),a("div",{staticClass:"tiao"},[a("i",{staticClass:"el-icon-star-off",class:{red:t.is_collected},on:{click:function(a){return e.toCollect(t)}}}),a("i",{staticClass:"el-icon-delete",on:{click:function(a){return e.toDel(t.id)}}})])],1)})),0),e.total>10?a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"prev, pager, next","current-page":e.reqParams.page,"page-size":e.reqParams.per_page,total:e.total},on:{"current-change":e.changePager}}):e._e()],1)],1)},r=[],i=(a("96cf"),a("1da1")),n=a("5f87"),c={name:"page-image",data:function(){return{reqParams:{collect:!1,page:1,per_page:10},images:[],total:0,imageUrl:null,dialogVisible:!1,headers:{Authorization:"Bearer ".concat(n["a"].getUser().token)}}},created:function(){this.getImages()},methods:{getImages:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("user/images",{params:e.reqParams});case 2:a=t.sent,e.images=a.data.data.results,e.total=a.data.data.total_count;case 5:case"end":return t.stop()}}),t)})))()},changePager:function(e){this.reqParams.page=e,this.getImages()},changeCollect:function(e){this.reqParams.collect=e,this.reqParams.page=1,this.reqParams.per_page=10,this.getImages()},toCollect:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=!e.is_collected,a.prev=1,a.next=4,t.$http.put("user/images/"+e.id,{collect:s});case 4:r="",r=s?"添加收藏成功":"取消收藏成功",t.$message({type:"success",message:r}),e.is_collected=s,a.next=15;break;case 10:a.prev=10,a.t0=a["catch"](1),i="",i=s?"添加收藏失败":"取消收藏失败",t.$message({type:"error",message:i});case 15:case"end":return a.stop()}}),a,null,[[1,10]])})))()},toDel:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.$http.delete("user/images/"+e);case 3:a.sent,t.$message({type:"success",message:"删除成功!"}),t.getImages(),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),t.$message({type:"info",message:"删除失败"});case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))).catch((function(){}));case 1:case"end":return a.stop()}}),a)})))()},openDialog:function(){this.dialogVisible=!0,this.imageUrl=null},uploadSuccess:function(e){var t=this;this.$message.success("上传素材成功"),this.imageUrl=e.data.url,window.setTimeout((function(){t.dialogVisible=!1,t.getImages()}),3e3)}}},l=c,o=(a("a74c"),a("2877")),u=Object(o["a"])(l,s,r,!1,null,"0b66038e",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-22172e6e.765881f1.js.map